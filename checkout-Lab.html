<!-- checkout-Lab.html -->
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>إتمام الطلب - معامل اقبال </title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { font-family: 'Tahoma', sans-serif; background: #f9f9f9; padding: 20px; }
.container { max-width: 600px; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 8px 16px rgba(0,0,0,0.2); }
.btn-custom { border-radius: 50px; padding: 8px 20px; }
</style>
</head>
<body>
<div class="container">
<h3 class="mb-3">إتمام الطلب</h3>
<form id="checkoutForm">
<div class="mb-2"><label>الاسم الكامل</label><input type="text" id="customerName" class="form-control" required></div>
<div class="mb-2"><label>رقم الهاتف</label><input type="tel" id="customerPhone" class="form-control" required></div>
<div class="mb-2"><label>العنوان</label><textarea id="customerAddress" class="form-control" required></textarea></div>
<div class="mb-2"><label>ملاحظات</label><textarea id="customerNotes" class="form-control"></textarea></div>
<p class="mb-2"><strong>منتجات السلة:</strong></p>
<ul id="cartItemsList" class="list-group mb-3"></ul>
<p class="mb-2"><strong>الإجمالي: </strong><span id="cartTotal">0</span> ج.م</p>
<button type="button" class="btn btn-success btn-custom w-100 mt-2" onclick="sendOrderWhatsApp()">تأكيد الطلب عبر واتساب</button>
</form>
</div>

<script>
let cart = JSON.parse(localStorage.getItem('cartItems')) || [];

function renderCart(){
const cartList = document.getElementById('cartItemsList');
cartList.innerHTML='';
let total = 0;
cart.forEach(item => {
total += item.price;
const li = document.createElement('li');
li.className = 'list-group-item';
li.textContent = `${item.name} - ${item.price} ج.م`;
cartList.appendChild(li);
});
document.getElementById('cartTotal').innerText = total;
}

function sendOrderWhatsApp(){
if(cart.length===0){alert('السلة فارغة!'); return;}
let name = document.getElementById('customerName').value;
let phone = document.getElementById('customerPhone').value;
let address = document.getElementById('customerAddress').value;
let notes = document.getElementById('customerNotes').value;
let orderDetails = cart.map(item => `${item.name} - ${item.price} ج.م`).join('%0A');
let total = cart.reduce((sum,item)=>sum+item.price,0);
let message = `طلب جديد:%0Aالاسم: ${name}%0Aالهاتف: ${phone}%0Aالعنوان: ${address}%0A---%0Aالمنتجات:%0A${orderDetails}%0A---%0Aالإجمالي: ${total} ج.م%0Aملاحظات: ${notes}`;
window.open(`https://wa.me/201275417454?text=${message}`,'_blank');
}

renderCart();
</script>
</body>
</html>
